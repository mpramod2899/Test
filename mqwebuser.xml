<?xml version="1.0" encoding="UTF-8"?>
<server>
    <!-- ****************************************************************** -->
    <!--                                                                    -->
    <!--  IBM MQ security configuration for MQ Console and REST API.        -->
    <!--                                                                    -->
    <!--  Name: local_os_registry.xml                                       -->
    <!--                                                                    -->
    <!--  Description:  Local Operating System user and group registry      -->
    <!--                                                                    -->
    <!-- ****************************************************************** -->
    <!-- <copyright                                                         -->
    <!--     notice='lm-source-program'                                     -->
    <!--     pids='5724-H72'                                                -->
    <!--     years='2017,2018'                                              -->
    <!--     crc='0' >                                                      -->
    <!--                                                                    -->
    <!--     Licensed Materials - Property of IBM                           -->
    <!--                                                                    -->
    <!--     5724-H72                                                       -->
    <!--                                                                    -->
    <!--     (C) Copyright IBM Corp. 2017, 2018 All Rights Reserved.        -->
    <!--                                                                    -->
    <!--     US Government Users Restricted Rights - Use, duplication or    -->
    <!--     disclosure restricted by GSA ADP Schedule Contract with        -->
    <!--     IBM Corp.                                                      -->
    <!-- </copyright>                                                       -->
    <!-- 
    This sample grants the following role mappings:
  
    1) MQWebAdmin role access to the 'mqm' group. When a user is a 
    member of this group, all MQ commands issued by the MQ Console or 
    REST API use the security context of the operating system user running
    the application server.
    
    2) MQWebAdminRO role is not associated with any users or groups.
  
    3) MQWebUser role access to all authenticated users. This role is used 
    by authenticated users where no other role is applicable. All MQ commands 
    issued by the MQ Console or REST API uses the security context of the 
    principal and so the user must be known to the queue manager and authorized 
    to issue the command.

    4) MFTWebAdmin role access to the 'mqm' group. When a user is a 
    member of this group, all Managed File Transfer commands issued by the 
    REST API use the security context of the operating system user running
    the application server.
    
    5) MFTWebAdminRO role is not associated with any users or groups.
	
 
    In addition the sample enables HTTP Basic Authentication.
    -->

    <!-- 
    Enable features 
    -->
    <featureManager>
        <feature>appSecurity-2.0</feature>
        <!-- <feature>localOSAuthenticationMQ-1.0</feature> -->
        <feature>basicAuthenticationMQ-1.0</feature>
 	<feature>requestTiming-1.0</feature>     
</featureManager>
<requestTiming hungRequestThreshold="3m" slowRequestThreshold="10s"/>
    <!-- 
    Roles for the MQ Console 
    -->
    <enterpriseApplication id="com.ibm.mq.console">
        <application-bnd>
            <security-role name="MQWebAdmin">
                <user name="pramod.madadi"/>
                <user name="brent.wright"/>
                <user name="Mark.Brown"/>
                <user name="ganavi.gurram"/>
                <user name="Ilavarasan.Anbudurai"/>
				<user name="ranjan.rajendran"/>
				<user name="jatinder.bali"/>
				<user name="kenneth.gentry"/>
				<user name="Sunil.Gurung"/>
                <!-- <group name="mqm"/> -->
                <!-- 
                Add users and/or groups here for full admin access
                -->                
            </security-role>
            <security-role name="MQWebAdminRO">
                <!-- <user name="pramod.madadi"/> -->
                <!-- <group name="user"/> -->
                <!-- 
                Add users and/or groups here for read-only access
                -->                
            </security-role>
            <security-role name="MQWebUser">
                <special-subject type="ALL_AUTHENTICATED_USERS"/>
            </security-role>
            <security-role name="MFTWebAdmin">
                <group name="mqm"/>
                <!-- 
                Add users and/or groups here for full admin access
                -->                
            </security-role>
            <security-role name="MFTWebAdminRO">
                <!-- 
                Add users and/or groups here for read-only access
                -->                
            </security-role>			
        </application-bnd>
    </enterpriseApplication>
	
	<!-- 
    Sample Basic Registry 
    -->
    <basicRegistry id="basic" realm="defaultRealm">
        <!-- 
        This sample defines two users with unencoded passwords
        and a group, these are used by the role mappings above.
        -->
        <user name="mqadmin" password="mqadmin"/>
        <user name="pramod.madadi" password="passw0rd"/>
		<user name="brent.wright" password="PigsKzw3LSsv"/>
		<user name="Mark.Brown" password="PigsKzw3LSsv"/>
		<user name="ganavi.gurram" password="PigsKzw3LSsv"/>
		<user name="Ilavarasan.Anbudurai" password="PigsKzw3LSsv"/>
		<user name="ranjan.rajendran" password="PigsKzw3LSsv"/>
		<user name="jatinder.bali" password="PigsKzw3LSsv"/>
		<user name="kenneth.gentry" password="PigsKzw3LSsv"/>
		<user name="Sunil.Gurung" password="PigsKzw3LSsv"/>
        <group name="MQWebAdminGroup">
           <member name="mqadmin"/>
		   <member name="pramod.madadi"/>
			<member name="brent.wright"/>
			<member name="Mark.Brown"/>
			<member name="ganavi.gurram"/>
			<member name="Ilavarasan.Anbudurai"/>
			<member name="ranjan.rajendran"/>
			<member name="jatinder.bali"/>
			<member name="kenneth.gentry"/>
			<member name="Sunil.Gurung"/>
        </group>
    </basicRegistry>

    <!-- 
    Roles for the MQ REST API 
    -->
    <enterpriseApplication id="com.ibm.mq.rest">
        <application-bnd>
            <security-role name="MQWebAdmin">
                <group name="mqm"/>
                <!-- 
                Add users and/or groups here for full admin access
                -->                
            </security-role>
            <security-role name="MQWebAdminRO">
                <!-- 
                Add users and/or groups here for read-only access
                -->                
            </security-role>
            <security-role name="MQWebUser">
                <special-subject type="ALL_AUTHENTICATED_USERS"/>
            </security-role>
            <security-role name="MFTWebAdmin">
                <group name="mqm"/>
                <!-- 
                Add users and/or groups here for full admin access
                -->                
            </security-role>
            <security-role name="MFTWebAdminRO">
                <!-- 
                Add users and/or groups here for read-only access
                -->                
            </security-role>						
        </application-bnd>
    </enterpriseApplication>

    <!-- 
    Local OS User Registry settings
    usePam controls whether user authentication uses Pluggable 
    Authentication Modules (PAM). On platforms that don't support
    PAM the value of this attribute is ignored.   
    -->
    <localOSAuthenticationMQ usePam="true"/>
    
    <!-- 
    Enable HTTPS on a specific port by uncommenting the line below and providing the required port number.
    -->
    
    <variable name="httpsPort" value="9443"/>
    
    
    <!-- 
    By default the server listens for HTTP/HTTPS requests on localhost only. To 
    listen on all available network interfaces uncomment the line below. To listen
    on a specific IP address or hostname replace the * with an appropriate value.
    -->
    
    <variable name="httpHost" value="*"/>
   
            
    <!--       
    Default MQ SSL configuration allows TLS v1.2 ONLY, refer to the 
    IBM Knowledge Center section on "IBM MQ Console and REST API security" 
    for details of how to configure security.
    -->             
    <sslDefault sslRef="mqDefaultSSLConfig"/>
                    
    <!-- 
    Enable client certificate authentication by uncommenting the
    block below and creating a trust.jks store. Local OS User registry
    maps the common name (CN=) issued by a trusted CA to
    users names in the registry. For example a certificate with 
    a distinguished name of 'CN=fred,O=IBM,C=GB' will be assigned
    roles for the local OS user fred and any associated groups.
           
    The default, auto-generated certificate held in key.jks is
    intended for developer convenience only, it is not intended for
    production use.

    Passwords for both defaultKeyStore and defaultTrustStore should
    be changed and encoded using the securityUtility tool, refer
    to the following developerWorks article for further information;

    https://developer.ibm.com/wasdev/docs/configuring-ssl-liberty/
    -->
    <!--
    <keyStore id="defaultKeyStore" location="key.jks" type="JKS" password="password"/>
    <keyStore id="defaultTrustStore" location="trust.jks" type="JKS" password="password"/>
    <ssl id="thisSSLConfig" clientAuthenticationSupported="true" keyStoreRef="defaultKeyStore" serverKeyAlias="default" trustStoreRef="defaultTrustStore" sslProtocol="TLSv1.2"/>
    <sslDefault sslRef="thisSSLConfig"/>    
    -->    
    
    <!--
    Uncomment the following two variables, and adjust them, to change 
    the default CORS settings.
    -->
    <!--
    <variable name="mqRestCorsAllowedOrigins" value="https://localhost:9883"/>
    <variable name="mqRestCorsMaxAgeInSeconds" value="120"/>
    -->    
	<variable name="traceSpec" value="*=info"/>
</server>
